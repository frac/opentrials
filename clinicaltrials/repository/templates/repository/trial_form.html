{% extends "repository/submission_step.html" %}
{% load i18n %}
{% load remark %}

{% block body %}

    {# A variavel de JS abaixo deve ser declarada sempre que houver um form com translation #}
    <script type="text/javascript">
        MULTILINGUAL_FIELDS = {
            available_languages: ['{{ CHECKED_CODES|join:"','" }}'],
            default_second_language: "{{ forms.0.default_second_language }}"
        };

        $(document).ready(function() {
            $("select[multiple]").asmSelect({
                    addItemTarget: 'bottom',
                    animate: true,
                    highlight: true,
                    sortable: false
            });
            $('td.help img').cluetip({local:true, cursor: 'pointer',showTitle: false});
        });
    </script>


    <h2>{{ title }}</h2>
    {% get_remarks title|slugify as remarks_list %}
    {{ remarks_list }}

    <form action="./" method="POST">{% csrf_token %}
        {% for form in forms %}
        <fieldset>
            <legend>{% firstof form.title form.form.title %}</legend>
            <table class="dataTable">
                {{ form.as_table }}
            </table>
        </fieldset>
        {% endfor %}

        {% for formset in formsets %}
            {{ formset.management_form }}
            <fieldset>
            <legend>{{ formset.form.title }}</legend>


            <div class="{{formset.management_form.prefix}}">
            {% for form in formset.forms %}
                <table class="dataTable">
                    {{ form.as_table }}
                </table>
            {% endfor %}
            </div>
            <div style="text-align: center">
              <input onclick="cloneMore('div.{{formset.management_form.prefix}} table:last','{{formset.management_form.prefix}}')" type="button" value="add more"/>
            </div>
            </fieldset>
        {% endfor %}
        <input type="submit" value="{% trans 'Save' %}"/>
    </form>

{% endblock %}
