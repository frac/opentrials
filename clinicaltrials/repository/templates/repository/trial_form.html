{% extends "repository/submission_step.html" %}
{% load i18n %}
{% load remark %}

{% block extrahead %}
        <link rel="stylesheet" type="text/css" href="/static/css/multilingual.css"/>
        <script type="text/javascript" src="/static/js/multilingual.js"></script>
{% endblock %}

{% block body %}

    {# A variavel de JS abaixo deve ser declarada sempre que houver um form com translation #}
    <script type="text/javascript">
        MULTILINGUAL_FIELDS = {
            available_languages: ['{{ MANAGED_LANGUAGES_LC|join:"','" }}'],
            default_second_language: 'pt-br'
        };

        $(document).ready(function() {
            $("select[multiple]").asmSelect({
                    addItemTarget: 'bottom',
                    animate: true,
                    highlight: true,
                    sortable: false
            });
            $('.dataTable th img').cluetip({local:true, cursor: 'pointer',showTitle: false});
        });
        function new_institution(){
            return window.open('{% url new_institution %}','n_i','status=0,location=0,height=375');
        }
    </script>

    <h2>{{ title }}</h2>
    <form action="./" method="POST">{% csrf_token %}
        {% for form in forms %}
        <fieldset>
            <legend>{% firstof form.title form.form.title %}</legend>
            <table class="dataTable" cellspacing="0">
                {{ form.as_table }}
            </table>
        </fieldset>
        {% endfor %}

        {% for formset in formsets %}
            {{ formset.management_form }}
            <fieldset>
            <legend>{{ formset.form.title }}</legend>


            <div class="{{formset.management_form.prefix}}">
            {% for form in formset.forms %}
                <table class="dataTable {% cycle 'even' 'odd' %}" cellspacing="0">
                    {{ form.as_table }}
                </table>
            {% endfor %}
            </div>
            <div style="text-align: center">
              <input onclick="cloneMore('div.{{formset.management_form.prefix}} table:last','{{formset.management_form.prefix}}')" type="button" value="add more"/>
              {% block extra_buttons %}{% endblock %}
            </div>
            </fieldset>
        {% endfor %}
        <input type="submit" value="{% trans 'Save' %}"/>
    </form>

{% endblock %}
